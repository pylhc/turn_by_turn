

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DOROS &mdash; turn_by_turn 0.9.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=988d0652" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=9dc39874"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Constants" href="../modules/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/omc_logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html#io">IO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#reading-data">Reading Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#writing-data">Writing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#supported-modules-and-limitations">Supported Modules and Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html#structures">Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html#utils">Utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Readers</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">DOROS</a></li>
<li class="toctree-l1"><a class="reference internal" href="#esrf">ESRF</a></li>
<li class="toctree-l1"><a class="reference internal" href="#iota">Iota</a></li>
<li class="toctree-l1"><a class="reference internal" href="#lhc">LHC</a></li>
<li class="toctree-l1"><a class="reference internal" href="#sps">SPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="#ptc">PTC</a></li>
<li class="toctree-l1"><a class="reference internal" href="#trackone">Trackone</a></li>
<li class="toctree-l1"><a class="reference internal" href="#mad-ng">MAD-NG</a></li>
<li class="toctree-l1"><a class="reference internal" href="#xtrack-line">XTRACK_LINE</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">turn_by_turn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">DOROS</li>
      <li class="wy-breadcrumbs-aside">
              <!-- User defined GitHub URL -->
              <a href="https://github.com/pylhc/turn_by_turn" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="doros">
<h1>DOROS<a class="headerlink" href="#doros" title="Link to this heading"></a></h1>
<p>Data handling for turn-by-turn measurement files from the
<code class="docutils literal notranslate"><span class="pre">DOROS</span></code> BPMs of the <code class="docutils literal notranslate"><span class="pre">LHC</span></code>  (files in <strong>hdf5</strong> format).</p>
<p>The file contains entries for <code class="docutils literal notranslate"><span class="pre">METADATA</span></code>, <code class="docutils literal notranslate"><span class="pre">TIMESTAMPS_INDEX</span></code> and
<code class="docutils literal notranslate"><span class="pre">TIMESTAMPS_TABLE</span></code>, which we do not use and
then the actual data per BPM.</p>
<p>These entries are as follows:</p>
<ul class="simple">
<li><p>The timetamps in microseconds.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">bstTimestamp</span></code>: timestamp of the trigger</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">acqStamp</span></code>: tiemstamp of the actual acquisition</p></li>
</ul>
</li>
<li><p>Position/Orbit entries are the average position of the beam per turn,
i.e. the turn-by-turn data averaged over all bunches, as DOROS cannot
distinguish between the bunches.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">nbOrbitSamplesRead</span></code>: number of orbit samples read</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">horPositions</span></code>: horizontal position of the beam per turn</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verPositions</span></code>: vertical position of the beam per turn</p></li>
</ul>
</li>
<li><p>Oscillation entries are the frequencies of change in position.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nbOscillationSamplesRead</span></code>: number of oscillation samples read</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">horOscillationData</span></code>: horizontal oscillation data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verOscillationData</span></code>: vertical oscillation data</p></li>
</ul>
</section>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turn_by_turn.doros.</span></span><span class="sig-name descname"><span class="pre">DataKeys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turn_by_turn/doros.html#DataKeys"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Class to handle the different entry keys for oscillations and positions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.doros.</span></span><span class="sig-name descname"><span class="pre">read_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bunch_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'oscillations'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TbtData</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/doros.html#read_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Reads turn-by-turn data from the <code class="docutils literal notranslate"><span class="pre">DOROS</span></code>’s <strong>SDDS</strong> format file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) -- path to the turn-by-turn measurement file.</p></li>
<li><p><strong>bunch_id</strong> (<em>int</em><em>, </em><em>optional</em>) -- the ID of the bunch in the file. Defaults to 0.</p></li>
<li><p><strong>data_type</strong> (<em>str</em>) -- Datatype to load. Defaults to “oscillations”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">TbTData</span></code> object with the loaded data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.doros.</span></span><span class="sig-name descname"><span class="pre">write_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbt_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TbtData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'oscillations'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/doros.html#write_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Writes turn-by-turn data to the <code class="docutils literal notranslate"><span class="pre">DOROS</span></code>’s <strong>SDDS</strong> format file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tbt_data</strong> (<em>TbtData</em>) -- data to be written</p></li>
<li><p><strong>file_path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) -- path to the turn-by-turn measurement file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<section id="esrf">
<h1>ESRF<a class="headerlink" href="#esrf" title="Link to this heading"></a></h1>
<p>Data handling for turn-by-turn measurement files from <code class="docutils literal notranslate"><span class="pre">ESRF</span></code> (files in <strong>matlab</strong> format).
This module is untested and should be considered experimental at the moment.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.esrf.</span></span><span class="sig-name descname"><span class="pre">load_esrf_mat_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/turn_by_turn/esrf.html#load_esrf_mat_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Reads the <strong>ESRF</strong> TbT <code class="docutils literal notranslate"><span class="pre">Matlab</span></code> file, checks for nans and matrices duplicities from consecutive kicks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) -- path to the turn-by-turn measurement file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D numpy array of BPM names and a 4D Numpy array [quantity, BPM, particle/bunch No.,
turn No.] quantities in order [x, y]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.esrf.</span></span><span class="sig-name descname"><span class="pre">read_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TbtData</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/esrf.html#read_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Reads turn-by-turn data from the <code class="docutils literal notranslate"><span class="pre">ESRF</span></code>’s <strong>Matlab</strong> format file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) -- path to the turn-by-turn measurement file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">TbTData</span></code> object with the loaded data.</p>
</dd>
</dl>
</dd></dl>

<section id="iota">
<h1>Iota<a class="headerlink" href="#iota" title="Link to this heading"></a></h1>
<p>Data handling for turn-by-turn measurement files from <code class="docutils literal notranslate"><span class="pre">Iota</span></code> (files in <strong>hdf5</strong> format).</p>
</section>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.iota.</span></span><span class="sig-name descname"><span class="pre">read_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdf5_version</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TbtData</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/iota.html#read_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Reads turn-by-turn data from <code class="docutils literal notranslate"><span class="pre">IOITA</span></code>’s <strong>hdf5</strong> format file.
As there are 2 possible versions of the HDF5 format, this will try them both successively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) -- path to the turn-by-turn measurement file.</p></li>
<li><p><strong>hdf5_version</strong> (<em>int</em>) -- the HDF5 format version to use when reading the written file. Defaults to the
latest, a.k.a 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">TbTData</span></code> object with the loaded data.</p>
</dd>
</dl>
</dd></dl>

<section id="lhc">
<h1>LHC<a class="headerlink" href="#lhc" title="Link to this heading"></a></h1>
<p>Data handling for turn-by-turn measurement files from the <code class="docutils literal notranslate"><span class="pre">LHC</span></code> (files in <strong>SDDS</strong> format).</p>
</section>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.lhc.</span></span><span class="sig-name descname"><span class="pre">read_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TbtData</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/lhc.html#read_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Reads turn-by-turn data from the <code class="docutils literal notranslate"><span class="pre">LHC</span></code>’s <strong>SDDS</strong> format file.
Will first determine if it is in ASCII format to figure out which reading method to use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) -- path to the turn-by-turn measurement file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">TbTData</span></code> object with the loaded data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.lhc.</span></span><span class="sig-name descname"><span class="pre">write_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbt_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TbtData</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/lhc.html#write_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Write a <code class="docutils literal notranslate"><span class="pre">TbtData</span></code> object’s data to file, in the <code class="docutils literal notranslate"><span class="pre">LHC</span></code>’s <strong>SDDS</strong> format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) -- path to a the disk location where to write the data.</p></li>
<li><p><strong>tbt_data</strong> (<em>TbtData</em>) -- the <code class="docutils literal notranslate"><span class="pre">TbtData</span></code> object to write to disk.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<section id="sps">
<h1>SPS<a class="headerlink" href="#sps" title="Link to this heading"></a></h1>
<p>Data handling for turn-by-turn measurement files from the <code class="docutils literal notranslate"><span class="pre">SPS</span></code> (files in <strong>SDDS</strong> format).</p>
</section>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.sps.</span></span><span class="sig-name descname"><span class="pre">read_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_trailing_bpm_plane</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TbtData</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/sps.html#read_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Reads turn-by-turn data from the <code class="docutils literal notranslate"><span class="pre">SPS</span></code>’s <strong>SDDS</strong> format file.
Will first determine if it is in ASCII format to figure out which reading method to use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em><em> | </em><em>Path</em>) -- path to the turn-by-turn measurement file.</p></li>
<li><p><strong>remove_trailing_bpm_plane</strong> (<em>bool</em><em>, </em><em>optional</em>) -- if <code class="docutils literal notranslate"><span class="pre">True</span></code>, will remove the trailing
BPM plane (‘.H’, ‘.V’) from the BPM-names.
This makes the measurement data compatible with the madx-models.
Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">TbTData</span></code> object with the loaded data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.sps.</span></span><span class="sig-name descname"><span class="pre">write_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbt_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TbtData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_trailing_bpm_plane</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/sps.html#write_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Write a <code class="docutils literal notranslate"><span class="pre">TbtData</span></code> object’s data to file, in a <code class="docutils literal notranslate"><span class="pre">SPS</span></code>’s <strong>SDDS</strong> format.
The format is reduced to the minimum parameters used by the reader.</p>
<dl class="simple">
<dt>WARNING: This writer uses <code class="docutils literal notranslate"><span class="pre">0</span></code> for horizontal and <code class="docutils literal notranslate"><span class="pre">1</span></code> for vertical BPMs</dt><dd><p>in the  <code class="docutils literal notranslate"><span class="pre">MonPlanes</span></code> array, i.e. the pre-2025 format.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_path</strong> (<em>str</em><em> | </em><em>Path</em>) -- path to a the disk location where to write the data.</p></li>
<li><p><strong>tbt_data</strong> (<em>TbtData</em>) -- the <code class="docutils literal notranslate"><span class="pre">TbtData</span></code> object to write to disk.</p></li>
<li><p><strong>add_trailing_bpm_plane</strong> (<em>bool</em><em>, </em><em>optional</em>) -- if <code class="docutils literal notranslate"><span class="pre">True</span></code>, will add the trailing
BPM plane (‘.H’, ‘.V’) to the BPM-names. This assures that all BPM-names are unique,
and that the measurement data is compatible with the sdds files from the FESA-class.
WARNING: If present, these will be used to determine the plane of the BPMs,
otherwise the <code class="docutils literal notranslate"><span class="pre">MonPlanes</span></code> array will be used.
Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<section id="ptc">
<h1>PTC<a class="headerlink" href="#ptc" title="Link to this heading"></a></h1>
<p>Data handling for turn-by-turn measurement files from the <code class="docutils literal notranslate"><span class="pre">PTC</span></code> code, which can be obtained by performing
particle tracking of your machine through the <code class="docutils literal notranslate"><span class="pre">MAD-X</span> <span class="pre">PTC</span></code> interface. The files are very close in
structure to <strong>TFS</strong> files, with the difference that the data part is split into “segments” relating
containing data for a given observation point.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turn_by_turn.ptc.</span></span><span class="sig-name descname"><span class="pre">Segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">turns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">element</span></span></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">name</span></span></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">number</span></span></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">particles</span></span></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">turns</span></span></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.ptc.</span></span><span class="sig-name descname"><span class="pre">read_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TbtData</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/ptc.html#read_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Reads turn-by-turn data from the <code class="docutils literal notranslate"><span class="pre">PTC</span></code> <strong>trackone</strong> format file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) -- path to the turn-by-turn measurement file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">TbTData</span></code> object with the loaded data.</p>
</dd>
</dl>
</dd></dl>

<section id="trackone">
<h1>Trackone<a class="headerlink" href="#trackone" title="Link to this heading"></a></h1>
<p>Data handling for turn-by-turn measurement files from the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> code, which can be obtained by performing
particle tracking of your machine through in <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>. The files are very close in structure to <strong>TFS</strong>
files, with the difference that the data part is split into “segments” relating containing data for a given
observation point.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.trackone.</span></span><span class="sig-name descname"><span class="pre">get_structure_from_trackone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nturns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npart</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'trackone'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/turn_by_turn/trackone.html#get_structure_from_trackone"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Extracts BPM names and particle coordinates in the <strong>trackone</strong> file produced by <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nturns</strong> (<em>int</em>) -- Number of turns tracked in the <strong>trackone</strong>, i.e. obtained from
<code class="docutils literal notranslate"><span class="pre">get_trackone_stats()</span></code>.</p></li>
<li><p><strong>npart</strong> (<em>int</em>) -- Number of particles tracked in the <strong>trackone</strong>, i.e. obtained from
<code class="docutils literal notranslate"><span class="pre">get_trackone_stats()</span></code>.</p></li>
<li><p><strong>file_path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) -- path to the turn-by-turn measurement file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array of BPM names and a 4D Numpy array [quantity, BPM, particle/bunch No.,
turn No.] quantities in order [x, px, y, py, t, pt, s, E].</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.trackone.</span></span><span class="sig-name descname"><span class="pre">get_trackone_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/turn_by_turn/trackone.html#get_trackone_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Determines the number of particles and turns in the matrices from the provided <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>
<strong>trackone</strong> file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) -- path to the turn-by-turn measurement file.</p></li>
<li><p><strong>write_out</strong> (<em>bool</em>) -- if <code class="docutils literal notranslate"><span class="pre">True</span></code>, write out the determined stats to a <strong>stats.txt</strong> file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple with the number of turns and particles.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.trackone.</span></span><span class="sig-name descname"><span class="pre">read_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_tracking_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TbtData</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/trackone.html#read_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Reads turn-by-turn data from the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <strong>trackone</strong> format file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) -- path to the turn-by-turn measurement file.</p></li>
<li><p><strong>is_tracking_data</strong> (<em>bool</em>) -- if <code class="docutils literal notranslate"><span class="pre">True</span></code>, all (<code class="docutils literal notranslate"><span class="pre">X</span></code>, <code class="docutils literal notranslate"><span class="pre">PX</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, <code class="docutils literal notranslate"><span class="pre">PY</span></code>,
<code class="docutils literal notranslate"><span class="pre">T</span></code>, <code class="docutils literal notranslate"><span class="pre">PT</span></code>, <code class="docutils literal notranslate"><span class="pre">S</span></code>, <code class="docutils literal notranslate"><span class="pre">E</span></code>) fields are expected in the file as it
is considered a full tracking simulation output. Those are then read
into <code class="docutils literal notranslate"><span class="pre">TrackingData</span></code> objects. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">TbTData</span></code> object with the loaded data.</p>
</dd>
</dl>
</dd></dl>

<section id="mad-ng">
<h1>MAD-NG<a class="headerlink" href="#mad-ng" title="Link to this heading"></a></h1>
<p>This module provides functions to read and write turn-by-turn measurement data
produced by the <code class="docutils literal notranslate"><span class="pre">MAD-NG</span></code> code. MAD-NG stores its tracking data in the <strong>TFS</strong>
(Table File System) file format.</p>
<p>Data is loaded into the standardized <code class="docutils literal notranslate"><span class="pre">TbtData</span></code> structure used by <code class="docutils literal notranslate"><span class="pre">turn_by_turn</span></code>,
allowing easy post-processing and conversion between formats.</p>
<dl class="simple">
<dt>Dependencies:</dt><dd><ul class="simple">
<li><p>Requires the <code class="docutils literal notranslate"><span class="pre">tfs-pandas</span> <span class="pre">&gt;=</span> <span class="pre">4.0.0</span></code> package for compatibility with MAD-NG
features. Earlier versions does not support MAD-NG TFS files.</p></li>
</ul>
</dd>
</dl>
</section>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.madng.</span></span><span class="sig-name descname"><span class="pre">convert_to_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pd.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tfs.TfsDataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TbtData</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/madng.html#convert_to_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convert a TFS or pandas DataFrame to a <code class="docutils literal notranslate"><span class="pre">TbtData</span></code> object.</p>
<p>This function parses the required turn-by-turn columns, reconstructs the
particle-by-particle tracking data, and returns a <code class="docutils literal notranslate"><span class="pre">TbtData</span></code> instance
that can be written or converted to other formats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.DataFrame</em><em> | </em><em>TfsDataFrame</em>) -- DataFrame containing MAD-NG turn-by-turn tracking data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The extracted and structured turn-by-turn data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>TbtData</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> -- If the input is not a recognized DataFrame type.</p></li>
<li><p><strong>ValueError</strong> -- If the data structure is inconsistent (e.g., lost particles).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.madng.</span></span><span class="sig-name descname"><span class="pre">read_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TbtData</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/madng.html#read_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Read turn-by-turn data from a MAD-NG TFS file.</p>
<p>Loads the TFS file using <code class="docutils literal notranslate"><span class="pre">tfs-pandas</span></code> and converts its contents into a
<code class="docutils literal notranslate"><span class="pre">TbtData</span></code> object for use with the <code class="docutils literal notranslate"><span class="pre">turn_by_turn</span></code> toolkit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em><em> | </em><em>Path</em>) -- Path to the MAD-NG TFS measurement file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded turn-by-turn data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>TbtData</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> -- If the <code class="docutils literal notranslate"><span class="pre">tfs-pandas</span></code> package is not installed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.madng.</span></span><span class="sig-name descname"><span class="pre">write_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbt_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TbtData</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/madng.html#write_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Write turn-by-turn data to a MAD-NG TFS file.</p>
<p>Takes a <code class="docutils literal notranslate"><span class="pre">TbtData</span></code> object and writes its contents to disk in the standard
TFS format used by MAD-NG, including relevant headers (date, time, origin).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_path</strong> (<em>str</em><em> | </em><em>Path</em>) -- Destination file path for the TFS file.</p></li>
<li><p><strong>tbt_data</strong> (<em>TbtData</em>) -- The turn-by-turn data to write.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> -- If the <code class="docutils literal notranslate"><span class="pre">tfs-pandas</span></code> package is not installed.</p>
</dd>
</dl>
</dd></dl>

<section id="xtrack-line">
<h1>XTRACK_LINE<a class="headerlink" href="#xtrack-line" title="Link to this heading"></a></h1>
<p>This module provides functions to convert tracking results from an <code class="docutils literal notranslate"><span class="pre">xtrack.Line</span></code>
into the standardized <code class="docutils literal notranslate"><span class="pre">TbtData</span></code> format used by <code class="docutils literal notranslate"><span class="pre">turn_by_turn</span></code>.</p>
<p>Prerequisites for using <code class="docutils literal notranslate"><span class="pre">convert_to_tbt</span></code>:</p>
<blockquote>
<div><ol class="arabic">
<li><p>The input <code class="docutils literal notranslate"><span class="pre">Line</span></code> must contain one or more <code class="docutils literal notranslate"><span class="pre">ParticlesMonitor</span></code> elements
positioned at each location where turn-by-turn data is required (e.g., all BPMs).</p>
<p>A valid monitor setup involves:</p>
<blockquote>
<div><ul>
<li><p>Placing a <code class="docutils literal notranslate"><span class="pre">xt.ParticlesMonitor</span></code> instance in the line’s element sequence
at all the places you would like to observe.</p></li>
<li><p>Configuring each monitor with identical settings:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">start_at_turn</span></code> (first turn to record, usually 0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop_at_turn</span></code> (The total number of turns to record, e.g., 100)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_particles</span></code> (number of tracked particles)</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>If any monitor is configured with different parameters, <code class="docutils literal notranslate"><span class="pre">convert_to_tbt</span></code>
will either find no data or raise an inconsistency error.</p>
<p>Also, if you specify more turns than were actually tracked, the resulting
TBT data will include all turns up to the monitor’s configured limit.
This may result in extra rows filled with zeros for turns where no real
data was recorded, which might not be desirable for your analysis.</p>
</li>
<li><p>Before conversion, you must:</p>
<blockquote>
<div><ul class="simple">
<li><p>Build particles with the desired initial coordinates
(using <code class="docutils literal notranslate"><span class="pre">line.build_particles(...)</span></code>).</p></li>
<li><p>Track those particles through the line for the intended number of turns
(using <code class="docutils literal notranslate"><span class="pre">line.track(...,</span> <span class="pre">num_turns=num_turns)</span></code>).</p></li>
</ul>
</div></blockquote>
</li>
</ol>
</div></blockquote>
<p>Once these conditions are met, pass the tracked <code class="docutils literal notranslate"><span class="pre">Line</span></code> to <code class="docutils literal notranslate"><span class="pre">convert_to_tbt</span></code> to
extract the data from each particle monitor into a <code class="docutils literal notranslate"><span class="pre">TbtData</span></code> object.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.xtrack_line.</span></span><span class="sig-name descname"><span class="pre">convert_to_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">xt.Line</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TbtData</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/xtrack_line.html#convert_to_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convert tracking results from an <code class="docutils literal notranslate"><span class="pre">xtrack</span></code> Line into a <code class="docutils literal notranslate"><span class="pre">TbtData</span></code> object.</p>
<p>This function extracts all <code class="docutils literal notranslate"><span class="pre">ParticlesMonitor</span></code> elements found in the Line,
verifies they contain consistent turn-by-turn data, and assembles the results
into the standard <code class="docutils literal notranslate"><span class="pre">TbtData</span></code> format. One <code class="docutils literal notranslate"><span class="pre">TransverseData</span></code> matrix is created
per tracked particle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xline</strong> (<em>Line</em>) -- An <code class="docutils literal notranslate"><span class="pre">xtrack.Line</span></code> containing at least one <code class="docutils literal notranslate"><span class="pre">ParticlesMonitor</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The extracted turn-by-turn data for all particles and monitors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>TbtData</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ImportError</strong> -- If the <code class="docutils literal notranslate"><span class="pre">xtrack</span></code> library is not installed.</p></li>
<li><p><strong>TypeError</strong> -- If the input is not a valid <code class="docutils literal notranslate"><span class="pre">xtrack.Line</span></code>.</p></li>
<li><p><strong>ValueError</strong> -- If no monitors are found or data is inconsistent.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">turn_by_turn.xtrack_line.</span></span><span class="sig-name descname"><span class="pre">read_tbt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/turn_by_turn/xtrack_line.html#read_tbt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Not implemented.</p>
<p>Reading TBT data directly from files is not supported for xtrack.
Use <code class="docutils literal notranslate"><span class="pre">convert_to_tbt</span></code> to convert an in-memory <code class="docutils literal notranslate"><span class="pre">xtrack.Line</span></code> instead.</p>
</dd></dl>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../modules/index.html" class="btn btn-neutral float-left" title="Constants" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>